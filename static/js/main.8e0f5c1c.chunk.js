(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,n){},102:function(e,t,n){},271:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n.n(o),a=n(93),l=n.n(a),i=(n(100),n(4)),c=n(5),r=n(8),u=n(6),d=n(7),h=n(3),p=(n(102),function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(r.a)(this,Object(u.a)(t).call(this,e))).wasDestroyed=!1,n.state={curX:e.initialX,curY:e.initialY,dx:Math.cos(e.angle)*e.velocity,dy:Math.sin(e.angle)*e.velocity},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={position:"relative",top:this.state.curY+"px",left:this.state.curX+"px",display:"block"};return s.a.createElement("svg",{style:e,height:"40px",width:"40px"},s.a.createElement("circle",{cx:"20px",cy:"20px",r:"20px",fill:this.props.playerColor}))}},{key:"bounce",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&this.setState({dy:-this.state.dy}),t&&this.setState({dx:-this.state.dx})}},{key:"updatePosition",value:function(){this.setState(function(e){return{curX:e.curX+e.dx,curY:e.curY+e.dy}})}},{key:"bounceOffPaddle",value:function(e){this.setState({dx:Math.cos(e)*this.props.velocity,dy:Math.sin(e)*this.props.velocity})}}]),t}(s.a.Component)),b=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(r.a)(this,Object(u.a)(t).call(this,e))).state={},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={height:this.props.playHeight/4+"px",width:"10px",background:this.props.color,position:"absolute",top:this.props.distanceFromWall+"px",left:"20px"};return s.a.createElement("div",{className:"paddle",style:e})}},{key:"redirectBall",value:function(e,t){var n=t-(this.props.distanceFromWall+this.props.playHeight/8),o=t-30;return Math.atan2(n,o)}}]),t}(s.a.Component),g=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(r.a)(this,Object(u.a)(t).call(this,e))).fieldInput=null,n.paddleRef=null,n.updaterID=void 0,n.state={needToUpdate:!1,paddleDistFromWall:20,balls:[{initialX:500,initialY:100,playerColor:n.props.playerColor,velocity:5,angle:-2,originatingPlayer:"me"}]},n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"addBall",value:function(e,t,n,o,s,a){var l=this.state.balls.slice(),i={initialX:e,initialY:t,playerColor:n,velocity:o,angle:s,originatingPlayer:a};console.log("newball was pushed to the list"),l.push(i),this.setState({balls:l})}},{key:"repositionBalls",value:function(){for(var e=[],t=this.state.balls,n=0;n<t.length;n++){console.log("NUMBER OF BALLS LOOP: "+t.length);var o=this.refs[t[n].originatingPlayer];if(o&&!o.wasDestroyed){if((o.state.curY+40>400||o.state.curY<0)&&o.bounce(),o.state.curY>=this.state.paddleDistFromWall&&o.state.curY<=this.state.paddleDistFromWall+100&&o.state.curX<=25&&null!==this.paddleRef){var s=this.paddleRef.redirectBall(o.state.curX,o.state.curY);o.bounceOffPaddle(s)}o.state.curX<=1?this.props.loseCallback("Lost","We're not sure yet"):o.state.curX>=770?(this.props.sendBallCallBack(o.state.curY),o.wasDestroyed=!0,t.splice(n,1),n-=1,console.log("NUMBER OF BALLS NOW!! ",t.length)):(o.updatePosition(),e.push(t[n]))}}this.setState({balls:e,needToUpdate:!0})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{style:{height:this.props.height+"px",width:this.props.width+"px",border:"solid",position:"relative",top:"0px"}},this.state.balls.map(function(e){return s.a.createElement(p,Object.assign({key:e.originatingPlayer},e,{ref:e.originatingPlayer}))}),s.a.createElement(b,{playHeight:400,distanceFromWall:this.state.paddleDistFromWall,color:this.props.playerColor,ref:function(t){return e.paddleRef=t}}),this.state.balls.length)}},{key:"componentDidMount",value:function(){var e=this;null!==this.fieldInput&&this.fieldInput.focus(),document.addEventListener("keypress",function(t){return e.handleInput(t)},!1),this.setState({needToUpdate:!0})}},{key:"componentWillUnmount",value:function(){}},{key:"componentDidUpdate",value:function(e,t){var n=this;this.state.needToUpdate&&!t.needToUpdate&&(setTimeout(function(){return n.repositionBalls()},10),this.setState({needToUpdate:!1}))}},{key:"handleInput",value:function(e){var t=0;"j"==e.key&&this.state.paddleDistFromWall<300?t=20:"k"==e.key&&this.state.paddleDistFromWall>=5&&(t=-20),this.setState({paddleDistFromWall:this.state.paddleDistFromWall+t})}}]),t}(o.Component),m=n(94),f=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(r.a)(this,Object(u.a)(t).call(this,e))).state={enteredUsername:"",ballColor:"#00FF00"},n.updateUsername=n.updateUsername.bind(Object(h.a)(Object(h.a)(n))),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"LoginPage"},s.a.createElement("h1",null,"WELCOME TO PIPE PONG"," "+this.state.enteredUsername.toUpperCase()+"!!!"),s.a.createElement("button",{onClick:function(){return e.handleJoin()},style:{background:this.state.ballColor}},"Join Game"),s.a.createElement("input",{value:this.state.enteredUsername,onChange:this.updateUsername}),s.a.createElement("br",null),s.a.createElement("h4",null,"Choose your color!"),s.a.createElement(m.TwitterPicker,{color:this.state.ballColor,onChange:function(t){return e.changeColor(t)}}),s.a.createElement("br",null),s.a.createElement("h3",null,"Rules"),s.a.createElement("p",null,"Welcome! This is just like a regular game of Pong, just hit the ball back towards the right with your paddle and stay in the game as long as possible.",s.a.createElement("br",null),"When a ball goes through a pipe it will go to the player listed on the pipe (So make sure to send lots to those high ranking players)",s.a.createElement("br",null)),s.a.createElement("h3",null,"Controls"),s.a.createElement("p",null,"Move your paddle up with 'k' and down with 'j'.",s.a.createElement("br",null),"HAVE THE 'click here to play' SELECTED TO BE ABLE TO MOVE THE  PADDLE",s.a.createElement("br",null)))}},{key:"handleJoin",value:function(){void 0!==this.props.handleJoin&&this.props.handleJoin(this.state.enteredUsername,this.state.ballColor)}},{key:"updateUsername",value:function(e){this.setState({enteredUsername:e.target.value})}},{key:"changeColor",value:function(e){this.setState({ballColor:e.hex})}}]),t}(s.a.Component),v=n(15),y=n.n(v),S=function(e){var t=new y.a.SolclientFactoryProperties;y.a.SolclientFactory.init(t);var n={session:null};return n.topicName=e,n.connected=!1,console.log('\n*** Publisher to topic "'+n.topicName+'" is ready to connect ***'),n.connect=function(){if(null===n.session){var e="ws://mr4b11zr98z.messaging.mymaas.net:80";if(0===e.lastIndexOf("ws://",0)||0===e.lastIndexOf("wss://",0)||0===e.lastIndexOf("http://",0)||0===e.lastIndexOf("https://",0)){var t="solace-cloud-client",o="13hvb0guu1h4c5934o0cjn1rkl",s="msgvpn-4b11zr985";if(e){console.log("Connecting to Solace message router using url: "+e),console.log("Client username: "+t),console.log("Solace message router VPN name: "+s);try{n.session=y.a.SolclientFactory.createSession({url:e,vpnName:s,userName:t,password:o})}catch(a){console.log(a.toString())}n.session.on(y.a.SessionEventCode.UP_NOTICE,function(e){n.connected=!0,console.log("=== Successfully connected and ready to publish messages. ===")}),n.session.on(y.a.SessionEventCode.CONNECT_FAILED_ERROR,function(e){n.connected=!1,console.log("Connection failed to the message router: "+e.infoStr+" - check correct parameter values and connectivity!")}),n.session.on(y.a.SessionEventCode.DISCONNECTED,function(e){n.connected=!1,console.log("Disconnected."),null!==n.session&&(n.session.dispose(),n.session=null)}),n.connectToSolace()}else console.log("Cannot connect: please specify all the Solace message router properties.")}else console.log("Invalid protocol - please use one of ws://, wss://, http://, https://")}else console.log("Already connected and ready to publish messages.")},n.connectToSolace=function(){try{n.session.connect()}catch(e){console.log(e.toString())}},n.publish=function(e){if(null!==n.session){var t=y.a.SolclientFactory.createMessage();t.setDestination(y.a.SolclientFactory.createTopicDestination(n.topicName)),t.setBinaryAttachment(e),t.setDeliveryMode(y.a.MessageDeliveryModeType.DIRECT),console.log('Publishing message "'+e+'" to topic "'+n.topicName+'"...');try{n.session.send(t),console.log("Message published.")}catch(o){console.log(o.toString())}}else console.log("Cannot publish because not connected to Solace message router.")},n.disconnect=function(){if(n.connected=!1,console.log("Disconnecting from Solace message router..."),null!==n.session)try{n.session.disconnect()}catch(e){console.log(e.toString())}else console.log("Not connected to Solace message router.")},n},O=n(15),C=function(e,t){var n=new O.SolclientFactoryProperties;O.SolclientFactory.init(n);var o={session:null};return o.topicName=e,o.subscribed=!1,o.connected=!1,console.log('\n*** Subscriber to topic "'+o.topicName+'" is ready to connect ***'),o.connect=function(){if(null===o.session){var e="ws://mr4b11zr98z.messaging.mymaas.net:80";if(0===e.lastIndexOf("ws://",0)||0===e.lastIndexOf("wss://",0)||0===e.lastIndexOf("http://",0)||0===e.lastIndexOf("https://",0)){var n="solace-cloud-client",s="13hvb0guu1h4c5934o0cjn1rkl",a="msgvpn-4b11zr985";if(e){console.log("Connecting to Solace message router using url: "+e),console.log("Client username: "+n),console.log("Solace message router VPN name: "+a);try{o.session=O.SolclientFactory.createSession({url:e,vpnName:a,userName:n,password:s})}catch(l){console.log(l.toString())}o.session.on(O.SessionEventCode.UP_NOTICE,function(e){console.log("=== Successfully connected and ready to subscribe. ==="),o.subscribe(),o.connected=!0}),o.session.on(O.SessionEventCode.CONNECT_FAILED_ERROR,function(e){o.connected=!1,console.log("Connection failed to the message router: "+e.infoStr+" - check correct parameter values and connectivity!")}),o.session.on(O.SessionEventCode.DISCONNECTED,function(e){o.connected=!1,console.log("Disconnected."),o.subscribed=!1,null!==o.session&&(o.session.dispose(),o.session=null)}),o.session.on(O.SessionEventCode.SUBSCRIPTION_ERROR,function(e){console.log("Cannot subscribe to topic: "+e.correlationKey)}),o.session.on(O.SessionEventCode.SUBSCRIPTION_OK,function(e){o.subscribed?(o.subscribed=!1,console.log("Successfully unsubscribed from topic: "+e.correlationKey)):(o.subscribed=!0,console.log("Successfully subscribed to topic: "+e.correlationKey),console.log("=== Ready to receive messages. ==="))}),o.session.on(O.SessionEventCode.MESSAGE,function(e){t(JSON.parse(e.Ok)),console.log('Received message: "'+e.getBinaryAttachment()+'", details:\n'+e.dump())}),o.connectToSolace()}else console.log("Cannot connect: please specify all the Solace message router properties.")}else console.log("Invalid protocol - please use one of ws://, wss://, http://, https://")}else console.log("Already connected and ready to subscribe.")},o.connectToSolace=function(){try{o.session.connect()}catch(e){console.log(e.toString())}},o.subscribe=function(){if(null!==o.session)if(o.subscribed)console.log('Already subscribed to "'+o.topicName+'" and ready to receive messages.');else{console.log("Subscribing to topic: "+o.topicName);try{o.session.subscribe(O.SolclientFactory.createTopicDestination(o.topicName),!0,o.topicName,1e4)}catch(e){console.log(e.toString())}}else console.log("Cannot subscribe because not connected to Solace message router.")},o.unsubscribe=function(){if(null!==o.session)if(o.subscribed){console.log("Unsubscribing from topic: "+o.topicName);try{o.session.unsubscribe(O.SolclientFactory.createTopicDestination(o.topicName),!0,o.topicName,1e4)}catch(e){console.log(e.toString())}}else console.log('Cannot unsubscribe because not subscribed to the topic "'+o.topicName+'"');else console.log("Cannot unsubscribe because not connected to Solace message router.")},o.disconnect=function(){if(o.connected=!1,console.log("Disconnecting from Solace message router..."),null!==o.session)try{o.session.disconnect()}catch(e){console.log(e.toString())}else console.log("Not connected to Solace message router.")},o},k=function e(t,n,o,s,a){Object(i.a)(this,e),this.connect=function(){this.joinPublisher.connect(),this.ballPublisher.connect(),this.leavePublisher.connect(),this.pongPublisher.connect(),this.joinSubscriber.connect(),this.ballSubscriber.connect(),this.leaveSubscriber.connect(),this.leaderboardSubscriber.connect(),this.pingSubscriber.connect()},this.publishJoin=function(e,t,n){var o={sessionId:e,name:t,color:n};this.joinPublisher.publish(JSON.stringify(o))},this.publishBall=function(e,t,n,o){var s={sessionId:e,targetSessionId:t,angle:n,velocity:o};this.ballPublisher.publish(JSON.stringify(s))},this.publishLeave=function(e,t,n){var o={sessionId:e,reason:t,killedBy:n};this.leavePublisher.publish(JSON.stringify(o))},this.publishPong=function(e){var t={sessionId:e};this.pongPublisher.publish(JSON.stringify(t))},this.publishTest=function(e){var t={item:e};this.testPublisher.publish(JSON.stringify(t))},this.joinPublisher=S("join"),this.ballPublisher=S("ball"),this.leavePublisher=S("leave"),this.pongPublisher=S("pong"),this.joinSubscriber=C("join",t),this.ballSubscriber=C("ball",n),this.leaveSubscriber=C("leave",o),this.leaderboardSubscriber=C("leaderboard",s),this.pingSubscriber=C("ping",a)},E=n(55);function j(e,t){return t.timeAlive<e.timeAlive?-1:t.timeAlive>e.timeAlive?1:0}Array.prototype.sum=function(e){for(var t=0,n=0,o=this.length;n<o;n++)t+=this[n][e];return t};var w=function(e){function t(e){return Object(i.a)(this,t),Object(r.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement(o.Fragment,null,s.a.createElement("tr",{width:this.props.width,height:this.props.height,y:this.props.y},s.a.createElement("td",{style:{backgroundColor:this.props.color,border:"15px solid white",borderLeftColor:this.props.color}},this.props.name)))}}]),t}(o.Component),B=function(e){function t(e){return Object(i.a)(this,t),Object(r.a)(this,Object(u.a)(t).call(this,e))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("table",{height:this.props.height,width:this.props.width,x:this.props.x,y:this.props.y},this.props.leaderboard.map(function(t){return s.a.createElement(w,{height:t.height,sessionId:t.sessionId,name:t.name,color:t.color,width:e.props.width,y:t.y})}))}}]),t}(o.Component),I=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(r.a)(this,Object(u.a)(t).call(this,e))).commHandler=void 0,n.pong=void 0,n.state={joined:!1,name:"",color:"#00FF00",sessionId:"",leaderboard:[],lost:!1},n.pong=null,n.leaderboardCallBack=n.leaderboardCallBack.bind(Object(h.a)(Object(h.a)(n))),n.leaveGame=n.leaveGame.bind(Object(h.a)(Object(h.a)(n))),n.loseGame=n.loseGame.bind(Object(h.a)(Object(h.a)(n))),n.sendBall=n.sendBall.bind(Object(h.a)(Object(h.a)(n))),n.ballCallBack=n.ballCallBack.bind(Object(h.a)(Object(h.a)(n))),n.pingCallBack=n.pingCallBack.bind(Object(h.a)(Object(h.a)(n))),n.commHandler=new k(n.joinCallBack,n.ballCallBack,n.leaveCallBack,n.leaderboardCallBack,n.pingCallBack),n.commHandler.connect(),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"join",value:function(e,t){var n=Object(E.v4)();this.setState({joined:!0,name:e,color:t,sessionId:n}),this.commHandler.publishJoin(n,e,t)}},{key:"leaderboardCallBack",value:function(e){var t=e.leaderboard;!function(e,t){var n=e.sum("timeAlive"),o=0;e.map(function(e){e.timeAlive=Date.now()-e.time,e.height=t*e.timeAlive/n,e.y=o,o+=e.height}),e.sort(j)}(t,400),this.setState({leaderboard:t})}},{key:"joinCallBack",value:function(e){console.log("Join Callback",e)}},{key:"leaveCallBack",value:function(e){console.log("Leave Callback",e)}},{key:"ballCallBack",value:function(e){console.log("a ball was found"),this.state.sessionId==e.targetSessionId&&(console.log("a ball was received"),this.generateBall(e.velocity,e.angle,e.sessionId))}},{key:"pingCallBack",value:function(){console.log("received ping"),this.commHandler.publishPong(this.state.sessionId)}},{key:"generateBall",value:function(e,t,n){console.log("A ball was made with\nvelocity: "+e+"\nangle: "+t);var o="black",s=!0,a=!1,l=void 0;try{for(var i,c=this.state.leaderboard[Symbol.iterator]();!(s=(i=c.next()).done);s=!0){var r=i.value;if(r.sessionId===n){o=r.color;break}}}catch(d){a=!0,l=d}finally{try{s||null==c.return||c.return()}finally{if(a)throw l}}var u=Object(E.v4)();this.pong&&(this.state.leaderboard[0].sessionId,this.pong.addBall(700,100,o,e,t,u))}},{key:"leaveGame",value:function(e,t,n){this.setState({joined:!1}),this.commHandler.publishLeave(e,t,n)}},{key:"loseGame",value:function(e,t){var n=this;this.setState({joined:!1,lost:!0}),setTimeout(function(){n.setState({lost:!1}),n.leaveGame(n.state.sessionId,e,t)},2e3)}},{key:"sendBall",value:function(e){var t=this.findPlayerByHeight(e),n=this.state.sessionId;this.commHandler.publishBall(n,t,2,5)}},{key:"findPlayerByHeight",value:function(e){var t=!0,n=!1,o=void 0;try{for(var s,a=this.state.leaderboard[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var l=s.value;if(e>=l.y&&e<l.y+l.height)return l.sessionId}}catch(i){n=!0,o=i}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}}},{key:"render",value:function(){var e=this;return this.state.lost?s.a.createElement("h1",null,"You Lost!"):this.state.joined?s.a.createElement(o.Fragment,null,s.a.createElement("table",null,s.a.createElement("tr",null,s.a.createElement("td",null,s.a.createElement(g,{key:"PONGGAME",ref:function(t){e.pong=t},height:400,width:800,leaderboard:this.state.leaderboard,playerColor:this.state.color,loseCallback:this.loseGame,sendBallCallBack:this.sendBall})),s.a.createElement("td",null,s.a.createElement(B,{leaderboard:this.state.leaderboard,height:400,width:80,x:720,y:"0"})))),s.a.createElement("button",{onClick:function(){return e.leaveGame(e.state.sessionId,"Left","Noone")}},"Leave")):s.a.createElement(f,{handleJoin:function(t,n){return e.join(t,n)}})}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},95:function(e,t,n){e.exports=n(271)}},[[95,2,1]]]);
//# sourceMappingURL=main.8e0f5c1c.chunk.js.map